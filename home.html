<!DOCTYPE html>

    <head>
        <meta charset="utf-8">
        
        <title>SNAKE!</title>
        <style> 
            #gameCanvas{
                display: block;
                margin-left: auto;
                margin-right: auto;
                
                background-color: lightgray;
                
            }
            #score{
                text-align: center;
            }
        
        </style>

        <script ></script>
    </head>
    <body >
        <p id ="score">SCORE: 0</p>
        <canvas id="gameCanvas" width="300" height="300">
            <script>
                var gameCanvas = document.getElementById("gameCanvas");
                var ctx = gameCanvas.getContext("2d");
                var baseSpeed = 10;
                var score = 0;
                var speedX = 0;
                var speedY = 10;
                var head = {x: 0, y:0};
                var food;
                var goingRight = false;
                var goingLeft = false;
                var goingUp = false;
                var goingDown = false;
                var alive = true;
                var snake = [
                    {x: 150, y: 150},
                    {x: 140, y: 150},
                    {x: 130, y: 150},
                    {x: 120, y: 150},
                    {x: 110, y: 150}]
                function drawSnake(){
                    ctx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
                    drawFood();
                    snake.forEach(function(snakePart){
                        ctx.beginPath();
                        ctx.fillStyle="green"
                        ctx.fillRect(snakePart.x, snakePart.y, 10, 10);
                        ctx.stroke();
                        
                    })
                }
                function drawFood(){
                        ctx.beginPath();
                        ctx.fillStyle = "red"
                        ctx.fillRect(food.x, food.y, 10, 10);
                        ctx.stroke();
                }
                function updateScore(){
                    
                    document.getElementById("score").innerHTML ="SCORE: "+score;
                }
                function spawnFood(){
                    var foodX;
                    var foodY;
                    while(true){
                        foodX = Math.floor(Math.random()*gameCanvas.width);
                        if(foodX%10==0)break;
                    }
                    while(true){
                        foodY = Math.floor(Math.random()*gameCanvas.width);
                        if(foodY%10==0)break;
                    }
                    
                    food = {x: foodX, y: foodY}

                }
                function shift(){
                    head = {x: snake[0].x + speedX , y: snake[0].y + speedY};
                    snake.forEach(function (snakePart){
                        if(head.x == snakePart.x && snakePart.y == head.y ) alive = false;
                        console.log("snake died")
                    })
                    snake.unshift(head);
                    

                    if(head.x == food.x && head.y == food.y){
                        score += 10;
                        spawnFood();
                    }else{
                        console.log("head: " +head.x + ": " + head.y);
                        console.log("food: "+ food.x + ": " + food.y);
                        
                        snake.pop();
                    }
                    

                }
                function checkAlive(){
                    snake.forEach(function(snakePart){
                        if(snakePart.x==gameCanvas.width||snakePart.x<0){
                            alive = false;
                            console.log("snake died");
                        }else if(snakePart.y==gameCanvas.height||snakePart.y<0){
                            alive = false;
                            console.log("snake died");
                        }
                    })
                }
                function update(){

                    setTimeout(function(){
                        
                        if(food == null){
                            spawnFood();
                        }
                        checkAlive();
                        shift();
                        drawSnake();
                        updateScore();
                        
                        if(alive){update();}
                    },100)
                }
                
                document.addEventListener('keydown', (e) => {
                    if (e.code === "ArrowUp" && speedY != baseSpeed) {speedY = -1*baseSpeed; speedX = 0;}
                    else if (e.code === "ArrowDown" && speedY != -1*baseSpeed) {speedY = baseSpeed; speedX = 0;}
                    else if (e.code === "ArrowRight" && speedX != -1*baseSpeed) {speedX = baseSpeed; speedY = 0;}
                    else if (e.code === "ArrowLeft" && speedX != baseSpeed) {speedX = -1*baseSpeed;speedY = 0;}

                });

                
                update();

            </script>
        
    
    </canvas>
       
        
    </body>
</html>